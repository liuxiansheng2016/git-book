# é—®é¢˜

### **æ•è·é”™è¯¯**

#### **ç»„ä»¶å†…å¤„ç†**ï¼š

åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ `try...catch` å—æˆ–åœ¨ `Observable` çš„ `subscribe` æ–¹æ³•ä¸­å¤„ç†é”™è¯¯ã€‚

#### **å…¨å±€æ•è·é”™è¯¯**

1. **window.onerror**
2. åˆ›å»ºä¸€ä¸ªå®ç° `ErrorHandler` æ¥å£çš„å…¨å±€é”™è¯¯å¤„ç†å™¨ç±»ï¼Œå¹¶åœ¨æ ¹æ¨¡å—ä¸­æä¾›è¯¥ç±»ã€‚

```
import { ErrorHandler, Injectable } from '@angular/core';

@Injectable()
export class GlobalErrorHandler implements ErrorHandler {
  handleError(error: any) {
    console.error('Global error:', error);
    // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçš„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œå¦‚å‘é€é”™è¯¯æŠ¥å‘Šåˆ°æœåŠ¡å™¨
  }
}
```

```
import { NgModule } from '@angular/core';
import { GlobalErrorHandler } from './global - error - handler';

@NgModule({
  providers: [
    { provide: ErrorHandler, useClass: GlobalErrorHandler }
  ]
})
export class AppModule { }
```

### åœ¨ Angular ä¸­ä¼˜åŒ–æ€§èƒ½

Angular åº”ç”¨ç¨‹åºçš„æ€§èƒ½ä¼˜åŒ–å¯ä»¥ä»å¤šä¸ªæ–¹é¢å…¥æ‰‹ï¼Œä¸‹é¢åˆ—å‡ºäº†ä¸€äº›å¸¸è§çš„ç­–ç•¥ï¼š

1. **ä½¿ç”¨ OnPush å˜æ›´æ£€æµ‹ç­–ç•¥**ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒAngular çš„å˜æ›´æ£€æµ‹æœºåˆ¶ä¼šæ£€æŸ¥æ‰€æœ‰ç»‘å®šçš„æ•°æ®æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚é‡‡ç”¨ `OnPush` ç­–ç•¥å¯ä»¥å‡å°‘ä¸å¿…è¦çš„å˜æ›´æ£€æµ‹ï¼Œæé«˜æ€§èƒ½
2. **æ‡’åŠ è½½æ¨¡å—**ï¼šåˆ©ç”¨ Angular çš„æ‡’åŠ è½½ç‰¹æ€§ï¼Œå¯ä»¥åœ¨ç”¨æˆ·è®¿é—®ç‰¹å®šè·¯ç”±æ—¶æ‰åŠ è½½ç›¸åº”çš„æ¨¡å—ï¼Œä»è€Œå‡å°‘åˆå§‹åŠ è½½æ—¶é—´
3. **ä½¿ç”¨è½»é‡çº§ç®¡é“**ï¼šå°½é‡ä½¿ç”¨çº¯ç®¡é“ï¼ˆpure pipesï¼‰ï¼Œé¿å…å¤æ‚çš„è®¡ç®—é€»è¾‘ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“å·¥ä½œ
4. **å¯ç”¨ç”Ÿäº§æ¨¡å¼**ï¼šç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨äº† AOT ç¼–è¯‘å’Œç”Ÿäº§æ¨¡å¼ï¼Œè¿™å°†ç§»é™¤è°ƒè¯•ä¿¡æ¯å¹¶æœ€å°åŒ–ä»£ç ä½“ç§¯
5. **ä¼˜åŒ–ç»„ä»¶çš„æ¸²æŸ“æ€§èƒ½**ï¼šæ¯”å¦‚ä½¿ç”¨ `trackBy` å‡½æ•°å¸®åŠ© `ngFor` æå‡åˆ—è¡¨æ¸²æŸ“æ•ˆç‡
6. **ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æŠ€æœ¯**ï¼šå½“å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æŠ€æœ¯ï¼Œåªæ¸²æŸ“å¯è§çš„éƒ¨åˆ†å†…å®¹ï¼Œä»¥æå‡æ»šåŠ¨æ€§èƒ½
7. **å…¶ä»–ä¼˜åŒ–æ‰‹æ®µ**ï¼šè¿˜åŒ…æ‹¬ç´¢å¼•æœ¯ã€å‹ç¼©æœ¯ã€ç¼“å­˜æœ¯ã€é¢„å–æœ¯ç­‰é€šç”¨çš„æ€§èƒ½ä¼˜åŒ–æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¸ä»…é€‚ç”¨äºåç«¯å¼€å‘ï¼Œä¹Ÿå¯ä»¥åº”ç”¨äºå‰ç«¯åœºæ™¯

#### ä¼˜åŒ– Angular åº”ç”¨çš„ SEO

ä¸ºäº†ä¼˜åŒ– Angular åº”ç”¨çš„ SEOï¼Œä½ å¯ä»¥é‡‡å–ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š

1. **æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR)**ï¼šä½¿ç”¨ Angular Universal æ¥å®ç°æœåŠ¡ç«¯æ¸²æŸ“ã€‚è¿™ä½¿å¾—æœç´¢å¼•æ“çˆ¬è™«å¯ä»¥ç›´æ¥è·å–åˆ°é¡µé¢çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¾èµ– JavaScript æ¸²æŸ“
2. **é¢„æ¸²æŸ“**ï¼šå¯¹äºé™æ€å†…å®¹ï¼Œå¯ä»¥è€ƒè™‘é¢„æ¸²æŸ“æŠ€æœ¯ï¼Œå¦‚ Scully æˆ–è€… prerender.ioï¼Œå®ƒä»¬å¯ä»¥åœ¨æ„å»ºæ—¶ç”Ÿæˆé™æ€ HTML æ–‡ä»¶
3. **Meta æ ‡ç­¾ç®¡ç†**ï¼šåŠ¨æ€è®¾ç½® meta æ ‡ç­¾æ˜¯æé«˜ SEO çš„ä¸€ä¸ªé‡è¦æ–¹é¢ã€‚å¯ä»¥é€šè¿‡ Angular çš„ Meta æœåŠ¡æ¥åŠ¨æ€åœ°è®¾ç½® titleã€description ç­‰ meta æ ‡ç­¾
4. **Stateful URLs** å’Œ **Configurable URLs**ï¼šç¡®ä¿ URL æ˜¯æœ‰æ„ä¹‰ä¸”æ˜“äºç†è§£çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿå‡†ç¡®åæ˜ é¡µé¢çš„å†…å®¹ã€‚åŒæ—¶é¿å…ä½¿ç”¨å“ˆå¸Œæ¨¡å¼ï¼ˆhash modeï¼‰ï¼Œé™¤éå¿…è¦ï¼Œå› ä¸ºè¿™ä¼šå½±å“ SEO
5. **æ€§èƒ½ä¼˜åŒ–**ï¼šåŒ…æ‹¬å‡å°‘åŠ è½½æ—¶é—´ã€æ‡’åŠ è½½æ¨¡å—ã€ä»£ç åˆ†å‰²ç­‰ã€‚æ›´å¿«çš„åŠ è½½é€Ÿåº¦æœ‰åŠ©äºæå‡ç”¨æˆ·ä½“éªŒï¼Œé—´æ¥å½±å“ SEO æ’å

## ä¼˜åŒ– **Angular é¡¹ç›®çš„æ„å»ºé€Ÿåº¦**&#x20;

### **ğŸ”¹ 1. å¯ç”¨ AOTï¼ˆAhead-of-Timeï¼‰ç¼–è¯‘**

**AOTï¼ˆé¢„ç¼–è¯‘ï¼‰** é€šè¿‡åœ¨ **æ„å»ºæ—¶** è¿›è¡Œç¼–è¯‘ï¼Œå‡å°‘è¿è¡Œæ—¶çš„ç¼–è¯‘å·¥ä½œï¼ŒåŠ å¿«åº”ç”¨å¯åŠ¨é€Ÿåº¦ã€‚\
âœ… **åœ¨ `angular.json` ä¸­å¯ç”¨ AOT**ï¼š

```json
"angularCompilerOptions": {
  "enableIvy": true,
  "strictInjectionParameters": true
}
```

âœ… **ç”Ÿäº§ç¯å¢ƒé»˜è®¤ä½¿ç”¨ AOT**ï¼š

```sh
ng build --prod
```

### **ğŸ”¹ 2. ä½¿ç”¨ Ivy ä»¥å‡å°‘æ„å»ºæ—¶é—´**

**Ivy** æ˜¯ Angular çš„æ–°ç¼–è¯‘å™¨ï¼Œæä¾›äº†æ›´å¿«çš„æ„å»ºæ—¶é—´å’Œæ›´å°çš„ Bundle ä½“ç§¯ã€‚\
âœ… **ç¡®ä¿åœ¨ `angular.json` ä¸­å¯ç”¨äº† Ivy**ï¼š

```json
"angularCompilerOptions": {
  "enableIvy": true
}
```

### **ğŸ”¹ 3. å¯ç”¨å¢é‡æ„å»ºï¼ˆBuild Cacheï¼‰**

**Angular 13+** ç‰ˆæœ¬æ”¯æŒ **å¢é‡ç¼–è¯‘**ï¼Œé¿å…é‡å¤ç¼–è¯‘æœªæ›´æ”¹çš„ä»£ç ã€‚\
âœ… **åœ¨ `angular.json` ä¸­å¯ç”¨**ï¼š

```json
"cli": {
  "cache": {
    "enabled": true,
    "path": ".angular/cache",
    "environment": "all"
  }
}
```

âœ… **æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜**ï¼ˆé¿å…ç¼“å­˜é—®é¢˜æ—¶ï¼‰ï¼š

```sh
ng cache clean
```

### **ğŸ”¹ 4. ä½¿ç”¨ ESBuild**

ä» **Angular 14+** å¼€å§‹ï¼Œ**ESBuild** æä¾›äº†æ›´å¿«çš„æ„å»ºé€Ÿåº¦ã€‚\
âœ… **ç¡®ä¿é¡¹ç›®å·²å‡çº§åˆ° Angular 14+**ï¼Œå®ƒä¼šè‡ªåŠ¨ä½¿ç”¨ ESBuildã€‚

### **ğŸ”¹ 5. ä»£ç åˆ†å‰²ï¼ˆLazy Loading & Differential Loadingï¼‰**

âœ… **æ¨¡å—çº§ Lazy Loading**ï¼š

```typescript
const routes: Routes = [
  { path: 'dashboard', loadChildren: () => import('./dashboard/dashboard.module').then(m => m.DashboardModule) }
];
```

âœ… **å¯ç”¨ Differential Loading**ï¼ˆåªç”Ÿæˆæµè§ˆå™¨æ”¯æŒçš„ä»£ç ï¼‰ï¼š

```sh
ng build --configuration production
```

âœ… **ä½¿ç”¨ `esbuild` æ¥æ›¿ä»£ Terser è¿›è¡Œ JS ä¼˜åŒ–**ï¼š

```sh
NG_BUILD_MANGLE=true ng build --prod
```

### **ğŸ”¹ 6. ä¼˜åŒ–ä¾èµ–é¡¹**

âœ… **ç§»é™¤ä¸å¿…è¦çš„ä¾èµ–**ï¼š

```sh
npm prune
```

âœ… **ä½¿ç”¨ `webpack-bundle-analyzer` æ£€æŸ¥ä¾èµ–ä½“ç§¯**ï¼š

```sh
npm install --save-dev webpack-bundle-analyzer
ng build --prod --stats-json
npx webpack-bundle-analyzer dist/stats.json
```

### **ğŸ”¹ 7. ç”Ÿäº§ç¯å¢ƒæ„å»ºä¼˜åŒ–**

âœ… **åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ `ng build --configuration=production`** âœ… **å¼€å¯ `sourceMap=false` ä»¥å‡å°‘æ„å»ºæ—¶é—´**

```json
"configurations": {
  "production": {
    "optimization": true,
    "sourceMap": false,
    "extractCss": true,
    "namedChunks": false,
    "aot": true
  }
}
```

### **ğŸ”¹ 8. ä½¿ç”¨ `ng serve --hmr` è¿›è¡Œçƒ­æ›´æ–°**

âœ… **å¯ç”¨ HMRï¼ˆHot Module Replacementï¼‰** ä»¥å‡å°‘å¼€å‘æ—¶çš„åˆ·æ–°æ—¶é—´ï¼š

```sh
ng serve --hmr
```

âœ… **åœ¨ `angular.json` ä¸­é…ç½® `hmr`**

```json
"configurations": {
  "hmr": {
    "sourceMap": false,
    "optimization": false
  }
}
```

### **ğŸ”¹ 9. ä»£ç ä¼˜åŒ–**

âœ… **å‡å°‘ä¸å¿…è¦çš„ `Change Detection`**ï¼Œä½¿ç”¨ `ChangeDetectionStrategy.OnPush` âœ… **é¿å…è¿‡å¤š `ngIf`ï¼Œä½¿ç”¨ `hidden` æˆ– `ng-container`** âœ… **é¿å… `console.log` å½±å“ç¼–è¯‘** âœ… **åˆç†ä½¿ç”¨ `trackBy` ä¼˜åŒ– `*ngFor`**

### **ğŸ”¹ 10. ä½¿ç”¨ `Nx` è¿›è¡Œæ›´å¿«çš„å¢é‡ç¼–è¯‘**

**Nx** æ˜¯ä¸€ä¸ªç”¨äºå¤§è§„æ¨¡ Angular é¡¹ç›®çš„æ„å»ºä¼˜åŒ–å·¥å…·ã€‚\
âœ… **å®‰è£… Nx å¹¶ä½¿ç”¨**

```sh
npx create-nx-workspace myworkspace
```

âœ… **å¯ç”¨ `Nx` å¢é‡ç¼–è¯‘**

```sh
nx build my-app --parallel
```

***

#### **ğŸ”¹ æ€»ç»“**

| **ä¼˜åŒ–æ–¹å¼**         | **ä½œç”¨**                   |
| ---------------- | ------------------------ |
| **AOT ç¼–è¯‘**       | æå‰ç¼–è¯‘å‡å°‘è¿è¡Œæ—¶å¼€é”€              |
| **Ivy ç¼–è¯‘å™¨**      | æé«˜æ„å»ºé€Ÿåº¦å’Œä½“ç§¯ä¼˜åŒ–              |
| **å¢é‡æ„å»º**         | é¿å…é‡å¤ç¼–è¯‘æœªæ›´æ”¹ä»£ç               |
| **Lazy Loading** | å‡å°‘åˆå§‹åŠ è½½æ—¶é—´                 |
| **ESBuild**      | æ›¿ä»£ Terser æé«˜æ„å»ºé€Ÿåº¦         |
| **ä¾èµ–ä¼˜åŒ–**         | å‡å°‘åŒ…å¤§å°å’Œç¼–è¯‘æ—¶é—´               |
| **ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–**       | ä½¿ç”¨ `sourceMap=false` ç­‰ä¼˜åŒ– |
| **HMR çƒ­æ›´æ–°**      | æé«˜å¼€å‘æ—¶çš„åˆ·æ–°é€Ÿåº¦               |
| **Nx å·¥å…·**        | æä¾›æ›´å¿«çš„å¢é‡æ„å»º                |
| **Webpack åˆ†æ**   | å‘ç°å¹¶ä¼˜åŒ–ä¾èµ–                  |

âœ… **æœ€ä½³å®è·µï¼š**

1. **å¼€å¯ Ivy + AOT**
2. **å¯ç”¨å¢é‡æ„å»ºï¼ˆBuild Cacheï¼‰**
3. **ä½¿ç”¨ Lazy Loading è¿›è¡Œä»£ç åˆ†å‰²**
4. **ä¼˜åŒ–ä¾èµ–é¡¹ï¼Œç§»é™¤æ— ç”¨ä»£ç **
5. **å¯ç”¨ ESBuild æå‡æ„å»ºé€Ÿåº¦**

å¦‚æœä½ çš„ Angular é¡¹ç›®æ„å»ºé€Ÿåº¦è¾ƒæ…¢ï¼Œç»“åˆä¸Šè¿°ä¼˜åŒ–ç­–ç•¥å¯ä»¥ **å¤§å¹…æå‡æ„å»ºé€Ÿåº¦** ğŸš€
